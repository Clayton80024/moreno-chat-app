(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,24166,e=>{"use strict";e.s(["countries",()=>a,"searchCountries",()=>r]);let a=[{code:"US",name:"United States",flag:"ðŸ‡ºðŸ‡¸"},{code:"CA",name:"Canada",flag:"ðŸ‡¨ðŸ‡¦"},{code:"GB",name:"United Kingdom",flag:"ðŸ‡¬ðŸ‡§"},{code:"AU",name:"Australia",flag:"ðŸ‡¦ðŸ‡º"},{code:"DE",name:"Germany",flag:"ðŸ‡©ðŸ‡ª"},{code:"FR",name:"France",flag:"ðŸ‡«ðŸ‡·"},{code:"IT",name:"Italy",flag:"ðŸ‡®ðŸ‡¹"},{code:"ES",name:"Spain",flag:"ðŸ‡ªðŸ‡¸"},{code:"NL",name:"Netherlands",flag:"ðŸ‡³ðŸ‡±"},{code:"SE",name:"Sweden",flag:"ðŸ‡¸ðŸ‡ª"},{code:"NO",name:"Norway",flag:"ðŸ‡³ðŸ‡´"},{code:"DK",name:"Denmark",flag:"ðŸ‡©ðŸ‡°"},{code:"FI",name:"Finland",flag:"ðŸ‡«ðŸ‡®"},{code:"CH",name:"Switzerland",flag:"ðŸ‡¨ðŸ‡­"},{code:"AT",name:"Austria",flag:"ðŸ‡¦ðŸ‡¹"},{code:"BE",name:"Belgium",flag:"ðŸ‡§ðŸ‡ª"},{code:"IE",name:"Ireland",flag:"ðŸ‡®ðŸ‡ª"},{code:"PT",name:"Portugal",flag:"ðŸ‡µðŸ‡¹"},{code:"GR",name:"Greece",flag:"ðŸ‡¬ðŸ‡·"},{code:"PL",name:"Poland",flag:"ðŸ‡µðŸ‡±"},{code:"CZ",name:"Czech Republic",flag:"ðŸ‡¨ðŸ‡¿"},{code:"HU",name:"Hungary",flag:"ðŸ‡­ðŸ‡º"},{code:"RO",name:"Romania",flag:"ðŸ‡·ðŸ‡´"},{code:"BG",name:"Bulgaria",flag:"ðŸ‡§ðŸ‡¬"},{code:"HR",name:"Croatia",flag:"ðŸ‡­ðŸ‡·"},{code:"SI",name:"Slovenia",flag:"ðŸ‡¸ðŸ‡®"},{code:"SK",name:"Slovakia",flag:"ðŸ‡¸ðŸ‡°"},{code:"LT",name:"Lithuania",flag:"ðŸ‡±ðŸ‡¹"},{code:"LV",name:"Latvia",flag:"ðŸ‡±ðŸ‡»"},{code:"EE",name:"Estonia",flag:"ðŸ‡ªðŸ‡ª"},{code:"JP",name:"Japan",flag:"ðŸ‡¯ðŸ‡µ"},{code:"KR",name:"South Korea",flag:"ðŸ‡°ðŸ‡·"},{code:"CN",name:"China",flag:"ðŸ‡¨ðŸ‡³"},{code:"IN",name:"India",flag:"ðŸ‡®ðŸ‡³"},{code:"SG",name:"Singapore",flag:"ðŸ‡¸ðŸ‡¬"},{code:"MY",name:"Malaysia",flag:"ðŸ‡²ðŸ‡¾"},{code:"TH",name:"Thailand",flag:"ðŸ‡¹ðŸ‡­"},{code:"ID",name:"Indonesia",flag:"ðŸ‡®ðŸ‡©"},{code:"PH",name:"Philippines",flag:"ðŸ‡µðŸ‡­"},{code:"VN",name:"Vietnam",flag:"ðŸ‡»ðŸ‡³"},{code:"BR",name:"Brazil",flag:"ðŸ‡§ðŸ‡·"},{code:"AR",name:"Argentina",flag:"ðŸ‡¦ðŸ‡·"},{code:"MX",name:"Mexico",flag:"ðŸ‡²ðŸ‡½"},{code:"CL",name:"Chile",flag:"ðŸ‡¨ðŸ‡±"},{code:"CO",name:"Colombia",flag:"ðŸ‡¨ðŸ‡´"},{code:"PE",name:"Peru",flag:"ðŸ‡µðŸ‡ª"},{code:"VE",name:"Venezuela",flag:"ðŸ‡»ðŸ‡ª"},{code:"EC",name:"Ecuador",flag:"ðŸ‡ªðŸ‡¨"},{code:"UY",name:"Uruguay",flag:"ðŸ‡ºðŸ‡¾"},{code:"PY",name:"Paraguay",flag:"ðŸ‡µðŸ‡¾"},{code:"BO",name:"Bolivia",flag:"ðŸ‡§ðŸ‡´"},{code:"ZA",name:"South Africa",flag:"ðŸ‡¿ðŸ‡¦"},{code:"NG",name:"Nigeria",flag:"ðŸ‡³ðŸ‡¬"},{code:"KE",name:"Kenya",flag:"ðŸ‡°ðŸ‡ª"},{code:"EG",name:"Egypt",flag:"ðŸ‡ªðŸ‡¬"},{code:"MA",name:"Morocco",flag:"ðŸ‡²ðŸ‡¦"},{code:"TN",name:"Tunisia",flag:"ðŸ‡¹ðŸ‡³"},{code:"DZ",name:"Algeria",flag:"ðŸ‡©ðŸ‡¿"},{code:"LY",name:"Libya",flag:"ðŸ‡±ðŸ‡¾"},{code:"SD",name:"Sudan",flag:"ðŸ‡¸ðŸ‡©"},{code:"ET",name:"Ethiopia",flag:"ðŸ‡ªðŸ‡¹"},{code:"GH",name:"Ghana",flag:"ðŸ‡¬ðŸ‡­"},{code:"CI",name:"Ivory Coast",flag:"ðŸ‡¨ðŸ‡®"},{code:"SN",name:"Senegal",flag:"ðŸ‡¸ðŸ‡³"},{code:"ML",name:"Mali",flag:"ðŸ‡²ðŸ‡±"},{code:"BF",name:"Burkina Faso",flag:"ðŸ‡§ðŸ‡«"},{code:"NE",name:"Niger",flag:"ðŸ‡³ðŸ‡ª"},{code:"TD",name:"Chad",flag:"ðŸ‡¹ðŸ‡©"},{code:"CM",name:"Cameroon",flag:"ðŸ‡¨ðŸ‡²"},{code:"CF",name:"Central African Republic",flag:"ðŸ‡¨ðŸ‡«"},{code:"GA",name:"Gabon",flag:"ðŸ‡¬ðŸ‡¦"},{code:"CG",name:"Congo",flag:"ðŸ‡¨ðŸ‡¬"},{code:"CD",name:"Democratic Republic of Congo",flag:"ðŸ‡¨ðŸ‡©"},{code:"AO",name:"Angola",flag:"ðŸ‡¦ðŸ‡´"},{code:"ZM",name:"Zambia",flag:"ðŸ‡¿ðŸ‡²"},{code:"ZW",name:"Zimbabwe",flag:"ðŸ‡¿ðŸ‡¼"},{code:"BW",name:"Botswana",flag:"ðŸ‡§ðŸ‡¼"},{code:"NA",name:"Namibia",flag:"ðŸ‡³ðŸ‡¦"},{code:"SZ",name:"Eswatini",flag:"ðŸ‡¸ðŸ‡¿"},{code:"LS",name:"Lesotho",flag:"ðŸ‡±ðŸ‡¸"},{code:"MG",name:"Madagascar",flag:"ðŸ‡²ðŸ‡¬"},{code:"MU",name:"Mauritius",flag:"ðŸ‡²ðŸ‡º"},{code:"SC",name:"Seychelles",flag:"ðŸ‡¸ðŸ‡¨"},{code:"RU",name:"Russia",flag:"ðŸ‡·ðŸ‡º"},{code:"UA",name:"Ukraine",flag:"ðŸ‡ºðŸ‡¦"},{code:"BY",name:"Belarus",flag:"ðŸ‡§ðŸ‡¾"},{code:"MD",name:"Moldova",flag:"ðŸ‡²ðŸ‡©"},{code:"GE",name:"Georgia",flag:"ðŸ‡¬ðŸ‡ª"},{code:"AM",name:"Armenia",flag:"ðŸ‡¦ðŸ‡²"},{code:"AZ",name:"Azerbaijan",flag:"ðŸ‡¦ðŸ‡¿"},{code:"KZ",name:"Kazakhstan",flag:"ðŸ‡°ðŸ‡¿"},{code:"UZ",name:"Uzbekistan",flag:"ðŸ‡ºðŸ‡¿"},{code:"TM",name:"Turkmenistan",flag:"ðŸ‡¹ðŸ‡²"},{code:"TJ",name:"Tajikistan",flag:"ðŸ‡¹ðŸ‡¯"},{code:"KG",name:"Kyrgyzstan",flag:"ðŸ‡°ðŸ‡¬"},{code:"MN",name:"Mongolia",flag:"ðŸ‡²ðŸ‡³"},{code:"TR",name:"Turkey",flag:"ðŸ‡¹ðŸ‡·"},{code:"IR",name:"Iran",flag:"ðŸ‡®ðŸ‡·"},{code:"IQ",name:"Iraq",flag:"ðŸ‡®ðŸ‡¶"},{code:"SA",name:"Saudi Arabia",flag:"ðŸ‡¸ðŸ‡¦"},{code:"AE",name:"United Arab Emirates",flag:"ðŸ‡¦ðŸ‡ª"},{code:"QA",name:"Qatar",flag:"ðŸ‡¶ðŸ‡¦"},{code:"KW",name:"Kuwait",flag:"ðŸ‡°ðŸ‡¼"},{code:"BH",name:"Bahrain",flag:"ðŸ‡§ðŸ‡­"},{code:"OM",name:"Oman",flag:"ðŸ‡´ðŸ‡²"},{code:"YE",name:"Yemen",flag:"ðŸ‡¾ðŸ‡ª"},{code:"JO",name:"Jordan",flag:"ðŸ‡¯ðŸ‡´"},{code:"LB",name:"Lebanon",flag:"ðŸ‡±ðŸ‡§"},{code:"SY",name:"Syria",flag:"ðŸ‡¸ðŸ‡¾"},{code:"IL",name:"Israel",flag:"ðŸ‡®ðŸ‡±"},{code:"PS",name:"Palestine",flag:"ðŸ‡µðŸ‡¸"},{code:"CY",name:"Cyprus",flag:"ðŸ‡¨ðŸ‡¾"},{code:"MT",name:"Malta",flag:"ðŸ‡²ðŸ‡¹"},{code:"IS",name:"Iceland",flag:"ðŸ‡®ðŸ‡¸"},{code:"LU",name:"Luxembourg",flag:"ðŸ‡±ðŸ‡º"},{code:"LI",name:"Liechtenstein",flag:"ðŸ‡±ðŸ‡®"},{code:"MC",name:"Monaco",flag:"ðŸ‡²ðŸ‡¨"},{code:"SM",name:"San Marino",flag:"ðŸ‡¸ðŸ‡²"},{code:"VA",name:"Vatican City",flag:"ðŸ‡»ðŸ‡¦"},{code:"AD",name:"Andorra",flag:"ðŸ‡¦ðŸ‡©"},{code:"NZ",name:"New Zealand",flag:"ðŸ‡³ðŸ‡¿"},{code:"FJ",name:"Fiji",flag:"ðŸ‡«ðŸ‡¯"},{code:"PG",name:"Papua New Guinea",flag:"ðŸ‡µðŸ‡¬"},{code:"SB",name:"Solomon Islands",flag:"ðŸ‡¸ðŸ‡§"},{code:"VU",name:"Vanuatu",flag:"ðŸ‡»ðŸ‡º"},{code:"NC",name:"New Caledonia",flag:"ðŸ‡³ðŸ‡¨"},{code:"PF",name:"French Polynesia",flag:"ðŸ‡µðŸ‡«"},{code:"WS",name:"Samoa",flag:"ðŸ‡¼ðŸ‡¸"},{code:"TO",name:"Tonga",flag:"ðŸ‡¹ðŸ‡´"},{code:"KI",name:"Kiribati",flag:"ðŸ‡°ðŸ‡®"},{code:"TV",name:"Tuvalu",flag:"ðŸ‡¹ðŸ‡»"},{code:"NR",name:"Nauru",flag:"ðŸ‡³ðŸ‡·"},{code:"PW",name:"Palau",flag:"ðŸ‡µðŸ‡¼"},{code:"FM",name:"Micronesia",flag:"ðŸ‡«ðŸ‡²"},{code:"MH",name:"Marshall Islands",flag:"ðŸ‡²ðŸ‡­"},{code:"CU",name:"Cuba",flag:"ðŸ‡¨ðŸ‡º"},{code:"JM",name:"Jamaica",flag:"ðŸ‡¯ðŸ‡²"},{code:"HT",name:"Haiti",flag:"ðŸ‡­ðŸ‡¹"},{code:"DO",name:"Dominican Republic",flag:"ðŸ‡©ðŸ‡´"},{code:"PR",name:"Puerto Rico",flag:"ðŸ‡µðŸ‡·"},{code:"TT",name:"Trinidad and Tobago",flag:"ðŸ‡¹ðŸ‡¹"},{code:"BB",name:"Barbados",flag:"ðŸ‡§ðŸ‡§"},{code:"GD",name:"Grenada",flag:"ðŸ‡¬ðŸ‡©"},{code:"LC",name:"Saint Lucia",flag:"ðŸ‡±ðŸ‡¨"},{code:"VC",name:"Saint Vincent and the Grenadines",flag:"ðŸ‡»ðŸ‡¨"},{code:"AG",name:"Antigua and Barbuda",flag:"ðŸ‡¦ðŸ‡¬"},{code:"KN",name:"Saint Kitts and Nevis",flag:"ðŸ‡°ðŸ‡³"},{code:"DM",name:"Dominica",flag:"ðŸ‡©ðŸ‡²"},{code:"BZ",name:"Belize",flag:"ðŸ‡§ðŸ‡¿"},{code:"GT",name:"Guatemala",flag:"ðŸ‡¬ðŸ‡¹"},{code:"HN",name:"Honduras",flag:"ðŸ‡­ðŸ‡³"},{code:"SV",name:"El Salvador",flag:"ðŸ‡¸ðŸ‡»"},{code:"NI",name:"Nicaragua",flag:"ðŸ‡³ðŸ‡®"},{code:"CR",name:"Costa Rica",flag:"ðŸ‡¨ðŸ‡·"},{code:"PA",name:"Panama",flag:"ðŸ‡µðŸ‡¦"},{code:"GY",name:"Guyana",flag:"ðŸ‡¬ðŸ‡¾"},{code:"SR",name:"Suriname",flag:"ðŸ‡¸ðŸ‡·"},{code:"GF",name:"French Guiana",flag:"ðŸ‡¬ðŸ‡«"},{code:"FK",name:"Falkland Islands",flag:"ðŸ‡«ðŸ‡°"},{code:"GS",name:"South Georgia and South Sandwich Islands",flag:"ðŸ‡¬ðŸ‡¸"}],r=e=>{if(!e.trim())return a;let r=e.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(r)||e.code.toLowerCase().includes(r))}},62060,e=>{"use strict";e.s(["UserPlusIcon",()=>r],62060);var a=e.i(71645);let r=a.forwardRef(function(e,r){let{title:t,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":l},n),t?a.createElement("title",{id:l},t):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))})},37163,e=>{"use strict";e.s(["useFriendRequests",()=>s,"useFriends",()=>d,"useUserSearch",()=>i]);var a=e.i(71645),r=e.i(55344),t=e.i(65300),l=e.i(83642),n=e.i(17927);function s(){let{friendRequests:e,refreshFriendRequests:s,addOptimisticFriendRequest:i}=(0,r.useRealtime)(),{user:d}=(0,l.useAuth)(),[o,c]=(0,a.useState)(!1),[m,g]=(0,a.useState)(null),[u,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{},[e]);let f=(0,a.useCallback)(async(e,a)=>{if(d&&!u){x(!0),g(null);try{let r=null;try{let{data:a}=await n.supabase.from("user_profiles").select("id, full_name, username, avatar_url, bio, is_online").eq("id",e).single();r=a}catch(e){console.warn("âš ï¸ Could not fetch receiver profile for optimistic update:",e)}let l={id:"temp-".concat(Date.now()),sender_id:d.id,receiver_id:e,status:"pending",message:a||void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),receiver_profile:r||{id:e,full_name:null,username:null,avatar_url:null,bio:null,is_online:!1}};i(l),await t.FriendsService.sendFriendRequest(d.id,e,a),await s()}catch(e){g(e instanceof Error?e.message:"Failed to send friend request")}finally{x(!1)}}},[d,u,s,i]),h=(0,a.useCallback)(async e=>{if(d&&!u){x(!0),g(null);try{await t.FriendsService.acceptFriendRequest(e,d.id),await s()}catch(e){g(e instanceof Error?e.message:"Failed to accept friend request")}finally{x(!1)}}},[d,u,s]),y=(0,a.useCallback)(async e=>{if(d&&!u){x(!0),g(null);try{await t.FriendsService.declineFriendRequest(e,d.id),await s()}catch(e){g(e instanceof Error?e.message:"Failed to decline friend request")}finally{x(!1)}}},[d,u,s]),b=(0,a.useCallback)(async e=>{if(d&&!u){x(!0),g(null);try{await t.FriendsService.declineFriendRequest(e,d.id),await s()}catch(e){g(e instanceof Error?e.message:"Failed to cancel friend request")}finally{x(!1)}}},[d,u,s]);return{sentRequests:e.sent,receivedRequests:e.received,loading:o,error:m,sendFriendRequest:f,acceptRequest:h,declineRequest:y,cancelRequest:b,isProcessing:u}}function i(e){let{query:r,limit:n=20}=e,{user:s}=(0,l.useAuth)(),[i,d]=(0,a.useState)([]),[o,c]=(0,a.useState)(!1),[m,g]=(0,a.useState)(null),u=(0,a.useCallback)(async e=>{if(!s||!e.trim())return void d([]);c(!0),g(null);try{let a=await t.FriendsService.searchUsers(e,s.id,n);d(a)}catch(e){g(e instanceof Error?e.message:"Failed to search users")}finally{c(!1)}},[s,n]);return(0,a.useEffect)(()=>{let e=setTimeout(()=>{u(r)},300);return()=>clearTimeout(e)},[r,u]),{users:i,loading:o,error:m,searchUsers:u}}function d(){let{user:e}=(0,l.useAuth)(),{friends:n}=(0,r.useRealtime)(),[s,i]=(0,a.useState)(!1),[d,o]=(0,a.useState)(null),[c,m]=(0,a.useState)(!1),g=(0,a.useCallback)(async a=>{if(e&&!c){m(!0),o(null);try{await t.FriendsService.removeFriend(e.id,a)}catch(e){o(e instanceof Error?e.message:"Failed to remove friend")}finally{m(!1)}}},[e,c]);return{friends:n,loading:s,error:d,removeFriend:g,blockUser:(0,a.useCallback)(async a=>{if(e&&!c){m(!0),o(null);try{await t.FriendsService.blockUser(e.id,a)}catch(e){o(e instanceof Error?e.message:"Failed to block user")}finally{m(!1)}}},[e,c]),unblockUser:(0,a.useCallback)(async a=>{if(e&&!c){m(!0),o(null);try{await t.FriendsService.unblockUser(e.id,a)}catch(e){o(e instanceof Error?e.message:"Failed to unblock user")}finally{m(!1)}}},[e,c]),isProcessing:c}}},43656,e=>{"use strict";e.s(["default",()=>w],43656);var a=e.i(43476),r=e.i(71645),t=e.i(62060),l=e.i(39875);let n=r.forwardRef(function(e,a){let{title:t,titleId:l,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":l},n),t?r.createElement("title",{id:l},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}),s=r.forwardRef(function(e,a){let{title:t,titleId:l,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":l},n),t?r.createElement("title",{id:l},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))});var i=e.i(27217),d=e.i(33576),o=e.i(37264),c=e.i(37163),m=e.i(55344),g=e.i(39931),u=e.i(93610),x=e.i(83642),f=e.i(70011),h=e.i(54878);let y={sm:"w-8 h-8 text-sm",md:"w-10 h-10 text-base",lg:"w-12 h-12 text-lg",xl:"w-16 h-16 text-xl"};function b(e){let{src:t,alt:l,size:n="md",className:s="",fallbackText:i}=e,[d,o]=(0,r.useState)(!1),[c,m]=(0,r.useState)(!1);if(!t||d){let e=i||l.charAt(0).toUpperCase();return(0,a.jsx)("div",{className:"\n        ".concat(y[n]," \n        bg-gradient-to-br from-primary-400 to-accent-400 \n        rounded-full flex items-center justify-center text-white font-bold \n        border-2 border-white shadow-md\n        ").concat(s,"\n      "),children:e})}return(0,a.jsxs)("div",{className:"relative ".concat(s),children:[!c&&(0,a.jsx)("div",{className:"\n          ".concat(y[n]," \n          bg-gradient-to-br from-primary-400 to-accent-400 \n          rounded-full flex items-center justify-center text-white font-bold \n          border-2 border-white shadow-md absolute inset-0\n        "),children:i||l.charAt(0).toUpperCase()}),(0,a.jsx)("img",{src:t,alt:l,className:"\n          ".concat(y[n]," \n          rounded-full object-cover border-2 border-white shadow-md\n          ").concat(c?"opacity-100":"opacity-0","\n          transition-opacity duration-200\n        "),onLoad:()=>{m(!0),console.log("ðŸŸ¢ Avatar loaded successfully:",t)},onError:e=>{console.error("ðŸ”´ Failed to load avatar:",t),o(!0)}})]})}var p=e.i(24166);function v(e){let{isOpen:t,onClose:n,onSendRequest:s,isProcessing:d}=e,[o,m]=(0,r.useState)(""),[g,u]=(0,r.useState)(""),[x,f]=(0,r.useState)(null),[y,v]=(0,r.useState)(null),[w,j]=(0,r.useState)(!1),{users:k,loading:N,error:S}=(0,c.useUserSearch)({query:o}),C=e=>{if(!e)return"";let a=p.countries.find(a=>a.name===e);return(null==a?void 0:a.flag)||""},_=()=>{j(!1),v(null)},U=async()=>{x&&(await s(x.id,g.trim()||void 0),f(null),u(""),n())};return(0,a.jsxs)(h.Dialog,{open:t,onClose:n,className:"relative z-50",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,a.jsx)(h.Dialog.Panel,{className:"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-xl shadow-xl relative",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)(h.Dialog.Title,{className:"text-lg font-semibold text-gray-900 dark:text-black mb-4",children:"Add Friend"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search for users"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.MagnifyingGlassIcon,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name or username...",value:o,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:bg-white dark:focus:bg-gray-600 transition-all"})]})]}),N&&(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"})}),S&&(0,a.jsx)("div",{className:"text-red-600 text-sm",children:S}),k.length>0&&(0,a.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-2",children:k.map(e=>(0,a.jsx)("div",{onClick:()=>{window.innerWidth<768?(v(e),j(!0)):f(e)},onMouseEnter:()=>{v(e),j(!0)},onMouseLeave:_,className:"p-3 rounded-lg cursor-pointer transition-all duration-200 ".concat((null==x?void 0:x.id)===e.id?"bg-primary-100 dark:bg-primary-900/20 border-2 border-primary-500 shadow-md":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 hover:shadow-sm"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(b,{src:e.avatar_url,alt:e.full_name||e.username||"Unknown User",size:"md",fallbackText:e.full_name||e.username||"?"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:e.full_name||e.username||"Unknown User"}),C(e.location)&&(0,a.jsx)("span",{className:"text-lg",title:e.location||"",children:C(e.location)})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:["@",e.username]}),e.mutual_friends&&e.mutual_friends>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:[e.mutual_friends," mutual friends"]})]})]})},e.id))}),w&&y&&(0,a.jsx)("div",{className:"hidden md:block absolute right-4 top-20 w-80 bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 z-10 p-4",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(b,{src:y.avatar_url,alt:y.full_name||y.username||"Unknown User",size:"lg",fallbackText:y.full_name||y.username||"?"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white truncate",children:y.full_name||y.username||"Unknown User"}),C(y.location)&&(0,a.jsx)("span",{className:"text-lg",title:y.location||"",children:C(y.location)})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:["@",y.username]}),y.bio&&(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2 overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:y.bio}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(y.is_online?"bg-green-500":"bg-gray-400")}),(0,a.jsx)("span",{children:y.is_online?"Online":"Offline"})]}),y.mutual_friends&&y.mutual_friends>0&&(0,a.jsxs)("span",{children:[y.mutual_friends," mutual friends"]})]})})]})]})}),w&&y&&(0,a.jsx)("div",{className:"md:hidden fixed inset-0 bg-black/50 z-50 flex items-end",children:(0,a.jsxs)("div",{className:"w-full bg-white dark:bg-gray-800 rounded-t-2xl p-6 max-h-[70vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Profile Preview"}),(0,a.jsx)("button",{onClick:()=>j(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,a.jsx)(i.XMarkIcon,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-4 mb-4",children:[(0,a.jsx)(b,{src:y.avatar_url,alt:y.full_name||y.username||"Unknown User",size:"xl",fallbackText:y.full_name||y.username||"?"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white truncate",children:y.full_name||y.username||"Unknown User"}),C(y.location)&&(0,a.jsx)("span",{className:"text-xl",title:y.location||"",children:C(y.location)})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:["@",y.username]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 mb-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(y.is_online?"bg-green-500":"bg-gray-400")}),(0,a.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:y.is_online?"Online":"Offline"})]}),y.mutual_friends&&y.mutual_friends>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[y.mutual_friends," mutual friends"]})]})]}),y.bio&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bio"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:y.bio})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>{f(y),j(!1)},className:"flex-1 px-4 py-2 bg-primary-600 text-black-700 rounded-lg hover:bg-primary-700 transition-colors font-medium",children:"Send Request"}),(0,a.jsx)("button",{onClick:()=>j(!1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Cancel"})]})]})}),x&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Message (optional)"}),(0,a.jsx)("textarea",{placeholder:"Add a personal message...",value:g,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:bg-white dark:focus:bg-gray-600 transition-all resize-none",rows:3})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:n,className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:U,disabled:!x||d,className:"flex-1 px-4 py-2 bg-primary-600 text-black rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Sending...":"Send Request"})]})]})})})]})}function w(){let[e,h]=(0,r.useState)("all"),[y,p]=(0,r.useState)(""),[w,j]=(0,r.useState)(!1),[k,N]=(0,r.useState)(new Set),{user:S}=(0,x.useAuth)(),{friends:C,loading:_}=(0,c.useFriends)(),{sentRequests:U,receivedRequests:F,sendFriendRequest:E,acceptRequest:A,declineRequest:R,cancelRequest:M,isProcessing:T}=(0,c.useFriendRequests)(),{onlineFriends:I,refreshFriendRequests:L}=(0,m.useRealtime)(),{addNotification:P}=(0,g.useNotifications)(),{addToast:G}=(0,u.useToast)(),B=async e=>{if(!k.has(e)){N(a=>new Set(a).add(e));try{await R(e),G({type:"success",title:"Friend Request Declined",message:"Request has been declined.",duration:2e3})}catch(e){G({type:"error",title:"Error",message:e instanceof Error?e.message:"Failed to decline friend request. Please try again.",duration:3e3})}finally{N(a=>{let r=new Set(a);return r.delete(e),r})}}},D=async e=>{if(!k.has(e)){N(a=>new Set(a).add(e));try{await M(e),G({type:"success",title:"Friend Request Cancelled",message:"Request has been cancelled.",duration:2e3})}catch(e){G({type:"error",title:"Error",message:e instanceof Error?e.message:"Failed to cancel friend request. Please try again.",duration:3e3})}finally{N(a=>{let r=new Set(a);return r.delete(e),r})}}},q=async e=>{try{if(!S)throw Error("User not authenticated");let a=await f.ChatsService.getOrCreateDirectChat(S.id,e);a&&(G({type:"success",title:"Chat Started",message:"Opening conversation...",duration:2e3}),setTimeout(()=>{window.location.href="/chats?chat=".concat(a.id)},1e3))}catch(e){G({type:"error",title:"Error",message:"Failed to start chat. Please try again.",duration:5e3})}},O=async(e,a)=>{if(!k.has(e)){N(a=>new Set(a).add(e));try{var r,t;let l=F.find(a=>a.id===e),n=(null==l||null==(r=l.sender_profile)?void 0:r.full_name)||(null==l||null==(t=l.sender_profile)?void 0:t.username)||"Unknown User";await A(e),G({type:"success",title:"Friend Request Accepted",message:"You are now friends with ".concat(n,"! Starting conversation..."),duration:3e3}),P({type:"friend_accepted",title:"Friend Request Accepted",message:"You are now friends with ".concat(n,"! Starting a conversation..."),data:{senderId:a,senderName:n},userId:(null==S?void 0:S.id)||""}),setTimeout(async()=>{try{if(!S)throw Error("User not authenticated");let e=await f.ChatsService.getOrCreateDirectChat(S.id,a);e&&(window.location.href="/chats?chat=".concat(e.id))}catch(e){G({type:"error",title:"Chat Error",message:"Failed to create chat. You can start a conversation from the friends list.",duration:5e3})}},1e3)}catch(e){G({type:"error",title:"Error",message:"Failed to accept friend request. Please try again.",duration:3e3})}finally{N(a=>{let r=new Set(a);return r.delete(e),r})}}},z=C.filter(a=>{if("online"===e&&!I.includes(a.friend_id))return!1;if(y){let e=a.friend_profile,r=(null==e?void 0:e.full_name)||"",t=(null==e?void 0:e.username)||"";return r.toLowerCase().includes(y.toLowerCase())||t.toLowerCase().includes(y.toLowerCase())}return!0}),K=C.filter(e=>I.includes(e.friend_id)).length;return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)("div",{className:"lg:hidden bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-20",children:(0,a.jsxs)("div",{className:"px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Friends"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[C.length," friends â€¢ ",K," online"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["pending"===e&&F.length>0&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.BellIcon,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center",children:F.length})]}),(0,a.jsx)("button",{onClick:()=>j(!0),className:"p-2 bg-primary-600 text-white rounded-lg shadow-md hover:bg-primary-700 transition-colors",children:(0,a.jsx)(t.UserPlusIcon,{className:"w-5 h-5 text-white"})})]})]}),(0,a.jsxs)("div",{className:"relative mb-3",children:[(0,a.jsx)(l.MagnifyingGlassIcon,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search friends...",value:y,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-primary-200 focus:bg-white dark:focus:bg-gray-600 transition-all"})]}),(0,a.jsxs)("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 p-1 rounded-lg",children:[(0,a.jsx)("button",{onClick:()=>h("all"),className:"flex-1 px-3 py-1.5 rounded-md text-xs font-medium transition-all ".concat("all"===e?"bg-white dark:bg-gray-600 text-primary-600 shadow-sm":"text-gray-600 dark:text-gray-400"),children:"All"}),(0,a.jsx)("button",{onClick:()=>h("online"),className:"flex-1 px-3 py-1.5 rounded-md text-xs font-medium transition-all ".concat("online"===e?"bg-white dark:bg-gray-600 text-primary-600 shadow-sm":"text-gray-600 dark:text-gray-400"),children:"Online"}),(0,a.jsxs)("button",{onClick:()=>h("pending"),className:"flex-1 px-3 py-1.5 rounded-md text-xs font-medium transition-all relative ".concat("pending"===e?"bg-white dark:bg-gray-600 text-primary-600 shadow-sm":"text-gray-600 dark:text-gray-400"),children:["Requests",F.length>0&&"pending"!==e&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-black text-xs rounded-full w-4 h-4 flex items-center justify-center",children:F.length})]})]})]})}),(0,a.jsxs)("div",{className:"hidden lg:block bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-8 py-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-black",children:"Friends"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[C.length," friends â€¢ ",K," online"]})]}),(0,a.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center px-5 py-3 bg-primary-600 text-black rounded-xl hover:bg-primary-700 active:bg-primary-800 transition-all shadow-lg hover:shadow-xl font-bold text-base",children:[(0,a.jsx)(t.UserPlusIcon,{className:"w-5 h-5 mr-2 text-black"}),"Add Friend"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 p-1 rounded-lg",children:[(0,a.jsx)("button",{onClick:()=>h("all"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all ".concat("all"===e?"bg-white dark:bg-gray-600 text-primary-600 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:"All Friends"}),(0,a.jsx)("button",{onClick:()=>h("online"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all ".concat("online"===e?"bg-white dark:bg-gray-600 text-primary-600 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:"Online"}),(0,a.jsxs)("button",{onClick:()=>h("pending"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all relative ".concat("pending"===e?"bg-white dark:bg-gray-600 text-primary-600 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:["Pending",F.length>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:F.length})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{className:"relative w-80",children:[(0,a.jsx)(l.MagnifyingGlassIcon,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search friends...",value:y,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-100 dark:bg-gray-700 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-primary-200 focus:bg-white dark:focus:bg-gray-600 transition-all"})]})})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto px-4 lg:px-8 py-4 lg:py-6",children:"pending"===e?(0,a.jsxs)("div",{className:"space-y-3 lg:space-y-4 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-base lg:text-lg font-semibold text-gray-900 dark:text-white",children:"Friend Requests"}),(0,a.jsxs)("button",{onClick:L,disabled:T,className:"px-3 py-1.5 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-1",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,a.jsx)("span",{children:"Refresh"})]})]}),F.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Received"}),(0,a.jsx)("div",{className:"space-y-3",children:F.map(e=>{var r,t,l,s,d,o,c,m;return(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(b,{src:null==(r=e.sender_profile)?void 0:r.avatar_url,alt:(null==(t=e.sender_profile)?void 0:t.full_name)||(null==(l=e.sender_profile)?void 0:l.username)||"Unknown User",size:"lg",fallbackText:(null==(s=e.sender_profile)?void 0:s.full_name)||(null==(d=e.sender_profile)?void 0:d.username)||"?"}),(0,a.jsxs)("div",{className:"ml-3 lg:ml-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:(null==(o=e.sender_profile)?void 0:o.full_name)||(null==(c=e.sender_profile)?void 0:c.username)||"Unknown User"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["@",null==(m=e.sender_profile)?void 0:m.username]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-0.5",children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 sm:ml-0",children:[(0,a.jsxs)("button",{onClick:()=>O(e.id,e.sender_id),disabled:k.has(e.id),className:"flex-1 sm:flex-none px-4 py-2.5 bg-primary-600 text-black rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors flex items-center justify-center font-bold shadow-md",children:[k.has(e.id)?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-1"}):(0,a.jsx)(n,{className:"w-4 h-4 mr-1 text-white"}),k.has(e.id)?"Accepting...":"Accept & Chat"]}),(0,a.jsxs)("button",{onClick:()=>B(e.id),disabled:k.has(e.id),className:"flex-1 sm:flex-none px-4 py-2.5 bg-white dark:bg-gray-700 border-2 border-gray-400 dark:border-gray-600 text-gray-900 dark:text-gray-100 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors flex items-center justify-center font-bold shadow-md",children:[k.has(e.id)?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-gray-700 dark:border-gray-300 border-t-transparent rounded-full animate-spin mr-1"}):(0,a.jsx)(i.XMarkIcon,{className:"w-4 h-4 mr-1 text-gray-700 dark:text-gray-300"}),k.has(e.id)?"Declining...":"Decline"]})]})]})},e.id)})})]}),U.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Sent"}),(0,a.jsx)("div",{className:"space-y-3",children:U.map(e=>{var r,t,l,n,s,i,d,o;return(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(b,{src:null==(r=e.receiver_profile)?void 0:r.avatar_url,alt:(null==(t=e.receiver_profile)?void 0:t.full_name)||(null==(l=e.receiver_profile)?void 0:l.username)||"Unknown User",size:"lg",fallbackText:(null==(n=e.receiver_profile)?void 0:n.full_name)||(null==(s=e.receiver_profile)?void 0:s.username)||"?"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-black",children:(null==(i=e.receiver_profile)?void 0:i.full_name)||(null==(d=e.receiver_profile)?void 0:d.username)||"Unknown User"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["@",null==(o=e.receiver_profile)?void 0:o.username]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Sent ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,a.jsx)("button",{onClick:()=>D(e.id),disabled:k.has(e.id),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:k.has(e.id)?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{children:"Cancelling..."})]}):"Cancel"})]})},e.id)})})]}),0===F.length&&0===U.length&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 text-center",children:[(0,a.jsx)(d.UserGroupIcon,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"No pending friend requests"})]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 lg:gap-4",children:_?(0,a.jsx)("div",{className:"col-span-full flex justify-center py-8",children:(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):0===z.length?(0,a.jsxs)("div",{className:"col-span-full bg-white dark:bg-gray-800 rounded-xl p-8 text-center",children:[(0,a.jsx)(d.UserGroupIcon,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:y?"No friends found matching your search":"No friends to display"})]}):z.map(e=>{let r,t,l=e.friend_profile,i=I.includes(e.friend_id);return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 lg:p-5 shadow-sm hover:shadow-md transition-all group",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(b,{src:null==l?void 0:l.avatar_url,alt:(null==l?void 0:l.full_name)||(null==l?void 0:l.username)||"Unknown User",size:"lg",fallbackText:(null==l?void 0:l.full_name)||(null==l?void 0:l.username)||"?"}),(0,a.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 lg:w-3.5 lg:h-3.5 ".concat((r=e.friend_id,I.includes(r)?"bg-green-500":"bg-gray-400")," rounded-full border-2 border-white dark:border-gray-800")})]}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-900 dark:text-white text-base lg:text-lg",children:(null==l?void 0:l.full_name)||(null==l?void 0:l.username)||"Unknown User"}),(0,a.jsxs)("p",{className:"text-sm lg:text-base text-gray-700 dark:text-gray-300 font-medium",children:["@",null==l?void 0:l.username]})]})]}),(0,a.jsx)("button",{className:"opacity-0 group-hover:opacity-100 lg:opacity-100 lg:group-hover:opacity-100 transition-opacity p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:(0,a.jsx)(s,{className:"w-4 h-4 lg:w-5 lg:h-5 text-gray-600 dark:text-gray-400"})})]}),(null==l?void 0:l.bio)&&(0,a.jsx)("p",{className:"text-sm lg:text-base text-gray-700 dark:text-gray-300 mb-3 line-clamp-2 font-medium",children:l.bio}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:(0,a.jsx)("span",{className:"text-sm px-2.5 py-1 lg:py-1.5 rounded-full font-semibold ".concat(i?"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-300"),children:(t=e.friend_id,I.includes(t)?"Active now":"Offline")})}),(0,a.jsx)("button",{onClick:()=>q(e.friend_id),className:"p-2 lg:p-2.5 bg-primary-100 dark:bg-primary-900/20 hover:bg-primary-200 dark:hover:bg-primary-900/30 rounded-lg transition-colors group/btn shadow-sm",children:(0,a.jsx)(n,{className:"w-5 h-5 lg:w-6 lg:h-6 text-primary-700 dark:text-primary-400 group-hover/btn:text-primary-800 dark:group-hover/btn:text-primary-300"})})]})]},e.id)})})}),(0,a.jsx)("button",{onClick:()=>j(!0),className:"lg:hidden fixed bottom-20 right-4 w-14 h-14 bg-primary-600 text-black rounded-full shadow-xl hover:bg-primary-700 active:bg-primary-800 transition-all flex items-center justify-center border-2 border-white dark:border-gray-800",children:(0,a.jsx)(t.UserPlusIcon,{className:"w-7 h-7 text-black"})}),(0,a.jsx)(v,{isOpen:w,onClose:()=>j(!1),onSendRequest:E,isProcessing:T})]})}}]);